"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var chai_1 = require("chai");
var fs = require("fs-extra");
var mocha_1 = require("mocha");
var spawnSync = require('child_process').spawnSync;
var constants_1 = require("../constants");
var functions_1 = require("../functions");
var utils_1 = require("../../src/utils");
mocha_1.describe('Test clasp logout function', function () {
    before(functions_1.setup);
    beforeEach(functions_1.backupSettings);
    mocha_1.it('should remove global AND local credentails', function () {
        fs.writeFileSync(constants_1.CLASP_PATHS.rcGlobal, constants_1.FAKE_CLASPRC.token);
        fs.writeFileSync(constants_1.CLASP_PATHS.rcLocal, constants_1.FAKE_CLASPRC.local);
        var result = spawnSync(constants_1.CLASP, ['logout'], { encoding: 'utf8' });
        chai_1.expect(fs.existsSync(constants_1.CLASP_PATHS.rcGlobal)).to.equal(false);
        chai_1.expect(utils_1.hasOauthClientSettings()).to.equal(false);
        chai_1.expect(fs.existsSync(constants_1.CLASP_PATHS.rcLocal)).to.equal(false);
        chai_1.expect(utils_1.hasOauthClientSettings(true)).to.equal(false);
        chai_1.expect(result.status).to.equal(0);
    });
    mocha_1.it('should still work with no clasprc file', function () {
        var result = spawnSync(constants_1.CLASP, ['logout'], { encoding: 'utf8' });
        chai_1.expect(fs.existsSync(constants_1.CLASP_PATHS.rcGlobal)).to.equal(false);
        chai_1.expect(utils_1.hasOauthClientSettings()).to.equal(false);
        chai_1.expect(fs.existsSync(constants_1.CLASP_PATHS.rcLocal)).to.equal(false);
        chai_1.expect(utils_1.hasOauthClientSettings(true)).to.equal(false);
        chai_1.expect(result.status).to.equal(0);
    });
    after(function () {
        functions_1.restoreSettings();
        functions_1.cleanup();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nb3V0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibG9nb3V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsNkJBQThCO0FBQzlCLDZCQUErQjtBQUMvQiwrQkFBcUM7QUFDN0IsSUFBQSw4Q0FBUyxDQUE4QjtBQUUvQywwQ0FJc0I7QUFFdEIsMENBS3NCO0FBRXRCLHlDQUV5QjtBQUV6QixnQkFBUSxDQUFDLDRCQUE0QixFQUFFO0lBQ3JDLE1BQU0sQ0FBQyxpQkFBSyxDQUFDLENBQUM7SUFDZCxVQUFVLENBQUMsMEJBQWMsQ0FBQyxDQUFDO0lBQzNCLFVBQUUsQ0FBQyw0Q0FBNEMsRUFBRTtRQUMvQyxFQUFFLENBQUMsYUFBYSxDQUFDLHVCQUFXLENBQUMsUUFBUSxFQUFFLHdCQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDM0QsRUFBRSxDQUFDLGFBQWEsQ0FBQyx1QkFBVyxDQUFDLE9BQU8sRUFBRSx3QkFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzFELElBQU0sTUFBTSxHQUFHLFNBQVMsQ0FDdEIsaUJBQUssRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxDQUN4QyxDQUFDO1FBQ0YsYUFBTSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsdUJBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDNUQsYUFBTSxDQUFDLDhCQUFzQixFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2pELGFBQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLHVCQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzNELGFBQU0sQ0FBQyw4QkFBc0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDckQsYUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3BDLENBQUMsQ0FBQyxDQUFDO0lBQ0gsVUFBRSxDQUFDLHdDQUF3QyxFQUFFO1FBQzNDLElBQU0sTUFBTSxHQUFHLFNBQVMsQ0FDdEIsaUJBQUssRUFBRSxDQUFDLFFBQVEsQ0FBQyxFQUFFLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxDQUN4QyxDQUFDO1FBQ0YsYUFBTSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsdUJBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDNUQsYUFBTSxDQUFDLDhCQUFzQixFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2pELGFBQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLHVCQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzNELGFBQU0sQ0FBQyw4QkFBc0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDckQsYUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3BDLENBQUMsQ0FBQyxDQUFDO0lBQ0gsS0FBSyxDQUFDO1FBQ0osMkJBQWUsRUFBRSxDQUFDO1FBQ2xCLG1CQUFPLEVBQUUsQ0FBQztJQUNaLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMifQ==